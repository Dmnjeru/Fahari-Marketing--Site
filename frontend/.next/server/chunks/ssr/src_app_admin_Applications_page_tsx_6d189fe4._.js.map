{"version":3,"sources":["turbopack:///[project]/src/app/admin/Applications/page.tsx"],"sourcesContent":["//frontend\\src\\app\\admin\\Applications\\page.tsx\r\n\"use client\";\r\n\r\nimport React, { useCallback, useEffect, useState } from \"react\";\r\nimport axios from \"axios\";\r\nimport { FiEye } from \"react-icons/fi\";\r\nimport { useRouter } from \"next/navigation\";\r\nimport Modal from \"../../components/Modal\";\r\nimport AdminLayout from \"../layout\";\r\n\r\ninterface Application {\r\n  _id: string;\r\n  name: string;\r\n  email: string;\r\n  phone?: string;\r\n  jobTitle: string;\r\n  jobId?: string;\r\n  cvUrl?: string;\r\n  status?: \"new\" | \"reviewed\" | \"shortlisted\" | \"rejected\";\r\n  createdAt: string;\r\n}\r\n\r\ninterface ApiErrorData {\r\n  message?: string;\r\n}\r\n\r\nconst ApplicationsPage: React.FC = () => {\r\n  const router = useRouter();\r\n  const [applications, setApplications] = useState<Application[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [selectedApp, setSelectedApp] = useState<Application | null>(null);\r\n  const [filter, setFilter] = useState(\"\");\r\n\r\n  const fetchApplications = useCallback(async () => {\r\n    setLoading(true);\r\n    setError(null);\r\n    try {\r\n      const res = await axios.get<{ success: boolean; data: Application[] }>(\r\n        \"/api/admin/applications\",\r\n        { withCredentials: true }\r\n      );\r\n      setApplications(res.data.data || []);\r\n    } catch (err: unknown) {\r\n      if (axios.isAxiosError(err)) {\r\n        const apiData = err.response?.data as ApiErrorData | undefined;\r\n        if (err.response?.status === 401) {\r\n          router.push(\"/admin/login\");\r\n          return;\r\n        }\r\n        setError(apiData?.message || err.message || \"Failed to fetch applications.\");\r\n      } else if (err instanceof Error) {\r\n        setError(err.message);\r\n      } else {\r\n        setError(\"Unknown error occurred while fetching applications.\");\r\n      }\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  }, [router]);\r\n\r\n  useEffect(() => {\r\n    fetchApplications();\r\n  }, [fetchApplications]);\r\n\r\n  const filteredApplications = applications.filter(\r\n    (app) =>\r\n      app.name.toLowerCase().includes(filter.toLowerCase()) ||\r\n      app.jobTitle.toLowerCase().includes(filter.toLowerCase())\r\n  );\r\n\r\n  return (\r\n    <AdminLayout>\r\n      <div className=\"p-4\">\r\n        <h1 className=\"text-2xl font-bold mb-2\">Applications</h1>\r\n        <p className=\"text-sm text-slate-500 mb-4\">\r\n          View and manage job applications.\r\n        </p>\r\n\r\n        <input\r\n          type=\"text\"\r\n          placeholder=\"Search by applicant name or job title...\"\r\n          value={filter}\r\n          onChange={(e) => setFilter(e.target.value)}\r\n          className=\"border p-2 rounded w-64 mb-4\"\r\n        />\r\n\r\n        {error && <div className=\"text-red-600 mb-3\">{error}</div>}\r\n\r\n        {loading ? (\r\n          <div className=\"py-6 text-center text-gray-600\">Loading applications...</div>\r\n        ) : filteredApplications.length === 0 ? (\r\n          <div className=\"py-6 text-center text-gray-600\">No applications found.</div>\r\n        ) : (\r\n          <div className=\"overflow-x-auto bg-white rounded shadow\">\r\n            <table className=\"w-full table-auto\">\r\n              <thead className=\"bg-gray-50\">\r\n                <tr>\r\n                  <th className=\"px-4 py-2 text-left text-sm font-medium\">Name</th>\r\n                  <th className=\"px-4 py-2 text-left text-sm font-medium\">Email</th>\r\n                  <th className=\"px-4 py-2 text-left text-sm font-medium\">Job</th>\r\n                  <th className=\"px-4 py-2 text-left text-sm font-medium\">Status</th>\r\n                  <th className=\"px-4 py-2 text-center text-sm font-medium\">Actions</th>\r\n                </tr>\r\n              </thead>\r\n              <tbody>\r\n                {filteredApplications.map((app) => (\r\n                  <tr key={app._id} className=\"border-t\">\r\n                    <td className=\"px-4 py-3\">{app.name}</td>\r\n                    <td className=\"px-4 py-3\">{app.email}</td>\r\n                    <td className=\"px-4 py-3\">{app.jobTitle}</td>\r\n                    <td className=\"px-4 py-3 capitalize\">\r\n                      {app.status || \"new\"}\r\n                    </td>\r\n                    <td className=\"px-4 py-3 text-center\">\r\n                      <button\r\n                        onClick={() => setSelectedApp(app)}\r\n                        className=\"text-blue-600 hover:text-blue-800\"\r\n                        title=\"View application details\"\r\n                      >\r\n                        <FiEye />\r\n                      </button>\r\n                    </td>\r\n                  </tr>\r\n                ))}\r\n              </tbody>\r\n            </table>\r\n          </div>\r\n        )}\r\n\r\n        {selectedApp && (\r\n          <Modal\r\n            title={`Application â€” ${selectedApp.name}`}\r\n            onClose={() => setSelectedApp(null)}\r\n          >\r\n            <div className=\"space-y-2\">\r\n              <p><strong>Name:</strong> {selectedApp.name}</p>\r\n              <p><strong>Email:</strong> {selectedApp.email}</p>\r\n              {selectedApp.phone && <p><strong>Phone:</strong> {selectedApp.phone}</p>}\r\n              <p><strong>Job:</strong> {selectedApp.jobTitle}</p>\r\n              <p><strong>Status:</strong> {selectedApp.status || \"new\"}</p>\r\n              <p><strong>Applied on:</strong> {new Date(selectedApp.createdAt).toLocaleString()}</p>\r\n              {selectedApp.cvUrl && (\r\n                <p>\r\n                  <a\r\n                    href={selectedApp.cvUrl}\r\n                    target=\"_blank\"\r\n                    rel=\"noopener noreferrer\"\r\n                    className=\"text-blue-600 hover:underline\"\r\n                  >\r\n                    View CV / Resume\r\n                  </a>\r\n                </p>\r\n              )}\r\n            </div>\r\n          </Modal>\r\n        )}\r\n      </div>\r\n    </AdminLayout>\r\n  );\r\n};\r\n\r\nexport default ApplicationsPage;\r\n"],"names":[],"mappings":"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"}