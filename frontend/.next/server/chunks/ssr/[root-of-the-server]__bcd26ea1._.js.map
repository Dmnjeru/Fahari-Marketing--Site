{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 82, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/njeru/fahari-marketing-site/frontend/src/app/admin/applications/page.tsx"],"sourcesContent":["// frontend/src/app/admin/applications/page.tsx\r\n\"use client\";\r\n\r\nimport React, { useState } from \"react\";\r\nimport { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\r\nimport axiosAuth from \"../../lib/axiosAuth\"; // âœ… use auth-aware axios\r\nimport { Button } from \"../../components/ui/button\";\r\nimport { Card, CardContent } from \"../../components/ui/card\";\r\nimport { Input } from \"../../components/ui/input\";\r\nimport {\r\n  Table,\r\n  TableBody,\r\n  TableHead,\r\n  TableHeader,\r\n  TableRow,\r\n  TableCell,\r\n} from \"../../components/ui/table\";\r\nimport { motion } from \"framer-motion\";\r\nimport { Trash2 } from \"lucide-react\";\r\nimport axios from \"axios\"; // keep only for isAxiosError type checking\r\n\r\nexport interface Application {\r\n  _id: string;\r\n  jobTitle: string;\r\n  applicantName: string;\r\n  applicantEmail: string;\r\n  status: \"pending\" | \"reviewed\" | \"rejected\" | \"accepted\";\r\n  submittedAt: string;\r\n}\r\n\r\nexport default function ApplicationsPage() {\r\n  const [search, setSearch] = useState(\"\");\r\n  const queryClient = useQueryClient();\r\n\r\n  // Fetch applications\r\n  const {\r\n    data: applications = [],\r\n    isLoading,\r\n    isError,\r\n    error,\r\n  } = useQuery<Application[]>({\r\n    queryKey: [\"admin-applications\", search],\r\n    queryFn: async () => {\r\n      const res = await axiosAuth.get<{ data: Application[] }>(\r\n        `/api/careers/applications?q=${encodeURIComponent(search)}`\r\n      );\r\n      return res.data?.data ?? [];\r\n    },\r\n  });\r\n\r\n  // Delete application mutation\r\n  const deleteMutation = useMutation<void, unknown, string>({\r\n    mutationFn: async (id: string) => {\r\n      await axiosAuth.delete(`/api/careers/applications/${encodeURIComponent(id)}`);\r\n    },\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries({ queryKey: [\"admin-applications\"] });\r\n    },\r\n  });\r\n\r\n  return (\r\n    <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} className=\"p-6 space-y-6\">\r\n      {/* HEADER */}\r\n      <div className=\"flex items-center justify-between\">\r\n        <h1 className=\"text-2xl font-bold\">Applications</h1>\r\n        <Input\r\n          placeholder=\"Search by applicant or job...\"\r\n          value={search}\r\n          onChange={(e) => setSearch(e.target.value)}\r\n          className=\"max-w-sm\"\r\n        />\r\n      </div>\r\n\r\n      {/* MAIN CARD */}\r\n      <Card className=\"shadow-md\">\r\n        <CardContent className=\"p-4 space-y-4\">\r\n          {/* LOADING */}\r\n          {isLoading && <p className=\"text-gray-500\">Loading applications...</p>}\r\n\r\n          {/* ERROR */}\r\n          {isError && (\r\n            <div className=\"text-red-600\">\r\n              <p>Failed to load applications.</p>\r\n              <p className=\"text-sm\">\r\n                {axios.isAxiosError(error)\r\n                  ? error.response?.data?.message || error.message\r\n                  : (error as Error).message}\r\n              </p>\r\n              <Button\r\n                variant=\"outline\"\r\n                size=\"sm\"\r\n                className=\"mt-2\"\r\n                onClick={() => queryClient.invalidateQueries({ queryKey: [\"admin-applications\"] })}\r\n              >\r\n                Retry\r\n              </Button>\r\n            </div>\r\n          )}\r\n\r\n          {/* NO RESULTS */}\r\n          {!isLoading && !isError && applications.length === 0 && (\r\n            <p className=\"text-gray-500\">No applications found.</p>\r\n          )}\r\n\r\n          {/* APPLICATION LIST */}\r\n          {!isLoading && applications.length > 0 && (\r\n            <div className=\"overflow-x-auto\">\r\n              <Table>\r\n                <TableHeader>\r\n                  <TableRow>\r\n                    <TableHead>Applicant Name</TableHead>\r\n                    <TableHead>Email</TableHead>\r\n                    <TableHead>Job Title</TableHead>\r\n                    <TableHead>Status</TableHead>\r\n                    <TableHead>Submitted At</TableHead>\r\n                    <TableHead>Actions</TableHead>\r\n                  </TableRow>\r\n                </TableHeader>\r\n\r\n                <TableBody>\r\n                  {applications.map((app) => (\r\n                    <TableRow key={app._id} className=\"hover:bg-gray-50\">\r\n                      <TableCell>{app.applicantName}</TableCell>\r\n                      <TableCell>{app.applicantEmail}</TableCell>\r\n                      <TableCell>{app.jobTitle}</TableCell>\r\n                      <TableCell className=\"capitalize\">{app.status}</TableCell>\r\n                      <TableCell>{new Date(app.submittedAt).toLocaleDateString()}</TableCell>\r\n                      <TableCell>\r\n                        <Button\r\n                          variant=\"destructive\"\r\n                          size=\"sm\"\r\n                          disabled={deleteMutation.isPending}\r\n                          onClick={() => {\r\n                            if (confirm(\"Are you sure you want to delete this application?\")) {\r\n                              deleteMutation.mutate(app._id);\r\n                            }\r\n                          }}\r\n                        >\r\n                          {deleteMutation.isPending ? \"Deleting...\" : <Trash2 size={16} />}\r\n                        </Button>\r\n                      </TableCell>\r\n                    </TableRow>\r\n                  ))}\r\n                </TableBody>\r\n              </Table>\r\n            </div>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n    </motion.div>\r\n  );\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}