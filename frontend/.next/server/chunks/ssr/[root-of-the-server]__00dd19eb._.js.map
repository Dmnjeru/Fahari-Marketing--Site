{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 3, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"","debugId":null}},
    {"offset": {"line": 23, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/njeru/fahari-marketing-site/frontend/src/app/blog/page.tsx"],"sourcesContent":["// frontend/src/app/blog/page.tsx\r\nimport type { Metadata } from \"next\";\r\nimport Image from \"next/image\";\r\nimport Link from \"next/link\";\r\n\r\nexport const metadata: Metadata = {\r\n  title: \"Blog — Fahari Yoghurt\",\r\n  description:\r\n    \"Read the latest news, recipes, and stories about Fahari Yoghurt and healthy living.\",\r\n  openGraph: {\r\n    title: \"Fahari Yoghurt Blog\",\r\n    description:\r\n      \"Stay up-to-date with Fahari Yoghurt's news, tips, and stories from the farm to your table.\",\r\n    url: \"https://faharidairies.co.ke/blog\",\r\n  },\r\n};\r\n\r\nexport const revalidate = 60; // seconds - ISR\r\n\r\ntype BlogItem = {\r\n  _id?: string;\r\n  id?: string;\r\n  title: string;\r\n  slug: string;\r\n  excerpt?: string;\r\n  image?: string;\r\n  category?: string;\r\n  tags?: string[];\r\n  author?: string;\r\n  views?: number;\r\n  // createdAt/updatedAt exist in DB but intentionally not shown to public UI\r\n};\r\n\r\ntype ApiResponse = {\r\n  success: boolean;\r\n  count?: number;\r\n  total?: number;\r\n  currentPage?: number;\r\n  totalPages?: number;\r\n  data?: BlogItem[];\r\n  message?: string;\r\n};\r\n\r\nconst DEFAULT_LIMIT = 9;\r\n\r\n/**\r\n * Helper: Build API URL (uses NEXT_PUBLIC_API_URL if provided, else relative)\r\n */\r\nfunction buildApiUrl(page = 1, limit = DEFAULT_LIMIT) {\r\n  const base = process.env.NEXT_PUBLIC_API_URL ?? \"\";\r\n  const prefix = base.endsWith(\"/\") || base === \"\" ? base.replace(/\\/$/, \"\") : base;\r\n  // if base is empty the resulting url begins with /api\r\n  return `${prefix}/api/blogs?page=${page}&limit=${limit}`;\r\n}\r\n\r\n/**\r\n * Server component page - reads searchParams for pagination\r\n */\r\nexport default async function BlogPage({\r\n  searchParams,\r\n}: {\r\n  searchParams?: { page?: string };\r\n}) {\r\n  const page = Math.max(1, Number(searchParams?.page ?? \"1\") || 1);\r\n  const limit = DEFAULT_LIMIT;\r\n  const url = buildApiUrl(page, limit);\r\n\r\n  let api: ApiResponse | null = null;\r\n  let fetchError: string | null = null;\r\n\r\n  try {\r\n    // fetch on the server; use Next.js ISR (revalidate above)\r\n    const res = await fetch(url, { next: { revalidate } });\r\n\r\n    if (!res.ok) {\r\n      fetchError = `Failed to load blogs: ${res.status} ${res.statusText}`;\r\n    } else {\r\n      api = (await res.json()) as ApiResponse;\r\n      if (!api || !Array.isArray(api.data)) {\r\n        fetchError = \"Unexpected API response\";\r\n      }\r\n    }\r\n  } catch (err) {\r\n    fetchError = (err as Error).message || \"Unknown error fetching blogs\";\r\n  }\r\n\r\n  const blogs = api?.data ?? [];\r\n\r\n  return (\r\n    <main className=\"min-h-screen bg-gray-50 px-6 py-12\">\r\n      <header className=\"max-w-3xl mx-auto text-center mb-12\">\r\n        <h1 className=\"text-4xl md:text-5xl font-extrabold text-gray-900 mb-4\">\r\n          Fahari Yoghurt Blog\r\n        </h1>\r\n        <p className=\"text-gray-600 text-lg\">\r\n          Stay up-to-date with our latest news, healthy tips, and delicious recipes.\r\n        </p>\r\n      </header>\r\n\r\n      <section className=\"max-w-7xl mx-auto\">\r\n        {fetchError ? (\r\n          <div className=\"rounded-md bg-red-50 border border-red-200 p-4 text-red-800\">\r\n            <strong className=\"block font-medium\">Error loading blogs</strong>\r\n            <p className=\"mt-1 text-sm\">{fetchError}</p>\r\n            <p className=\"mt-2 text-xs text-gray-600\">\r\n              If this continues, check your backend or environment variable <code>NEXT_PUBLIC_API_URL</code>.\r\n            </p>\r\n          </div>\r\n        ) : blogs.length === 0 ? (\r\n          <div className=\"text-center py-12 text-gray-600\">No blog posts found.</div>\r\n        ) : (\r\n          <>\r\n            <div className=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8\">\r\n              {blogs.map((b) => (\r\n                <article\r\n                  key={b._id ?? b.id ?? b.slug}\r\n                  className=\"bg-white rounded-2xl shadow-sm overflow-hidden hover:shadow-lg transition-shadow duration-200\"\r\n                >\r\n                  <Link href={`/blog/${b.slug}`} className=\"block focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-green-500\">\r\n                    <div className=\"relative h-44 w-full\">\r\n                      {b.image ? (\r\n                        <Image\r\n                          src={b.image}\r\n                          alt={b.title}\r\n                          fill\r\n                          sizes=\"(max-width: 768px) 100vw, 33vw\"\r\n                          style={{ objectFit: \"cover\" }}\r\n                          priority={false}\r\n                        />\r\n                      ) : (\r\n                        <div className=\"h-44 w-full bg-gray-100 flex items-center justify-center text-gray-400\">\r\n                          No image\r\n                        </div>\r\n                      )}\r\n                    </div>\r\n\r\n                    <div className=\"p-4\">\r\n                      <h2 className=\"text-lg font-semibold text-gray-900 mb-2 line-clamp-2\">\r\n                        {b.title}\r\n                      </h2>\r\n\r\n                      <p className=\"text-sm text-gray-600 mb-4 line-clamp-3\">\r\n                        {b.excerpt ?? \"Read more about this topic...\"}\r\n                      </p>\r\n\r\n                      <div className=\"flex items-center justify-between text-sm text-gray-500\">\r\n                        <span className=\"inline-flex items-center gap-2\">\r\n                          <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden>\r\n                            <path d=\"M12 5v14M5 12h14\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n                          </svg>\r\n                          <span>{b.category ?? \"Fahari\"}</span>\r\n                        </span>\r\n\r\n                        <span className=\"inline-flex items-center gap-2\">\r\n                          <svg className=\"w-4 h-4\" viewBox=\"0 0 24 24\" fill=\"none\" aria-hidden>\r\n                            <path d=\"M12 4v6l4 2\" stroke=\"currentColor\" strokeWidth=\"1.5\" strokeLinecap=\"round\" strokeLinejoin=\"round\"/>\r\n                          </svg>\r\n                          <span>{typeof b.views === \"number\" ? `${b.views}` : \"—\"}</span>\r\n                        </span>\r\n                      </div>\r\n                    </div>\r\n                  </Link>\r\n                </article>\r\n              ))}\r\n            </div>\r\n\r\n            {/* Pagination */}\r\n            <Pagination\r\n              currentPage={api?.currentPage ?? page}\r\n              totalPages={api?.totalPages ?? Math.ceil((api?.total ?? blogs.length) / limit)}\r\n              basePath=\"/blog\"\r\n            />\r\n          </>\r\n        )}\r\n      </section>\r\n    </main>\r\n  );\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                             Pagination component                            */\r\n/* -------------------------------------------------------------------------- */\r\nfunction Pagination({\r\n  currentPage,\r\n  totalPages,\r\n  basePath,\r\n}: {\r\n  currentPage: number;\r\n  totalPages: number;\r\n  basePath: string;\r\n}) {\r\n  const page = Math.max(1, currentPage || 1);\r\n  const total = Math.max(1, totalPages || 1);\r\n  const showPrev = page > 1;\r\n  const showNext = page < total;\r\n\r\n  const pageNumbers = getPageNumbers(page, total);\r\n\r\n  return (\r\n    <nav aria-label=\"Blog pagination\" className=\"mt-8 flex items-center justify-center\">\r\n      <ul className=\"inline-flex items-center gap-2\">\r\n        <li>\r\n          {showPrev ? (\r\n            <Link href={`${basePath}?page=${page - 1}`} className=\"px-3 py-2 rounded-md bg-white border text-gray-700 hover:bg-gray-50\">\r\n              Previous\r\n            </Link>\r\n          ) : (\r\n            <span className=\"px-3 py-2 rounded-md bg-gray-100 text-gray-400 border\">Previous</span>\r\n          )}\r\n        </li>\r\n\r\n        {pageNumbers.map((p) => (\r\n          <li key={p}>\r\n            {p === page ? (\r\n              <span className=\"px-3 py-2 rounded-md bg-green-600 text-white border\">{p}</span>\r\n            ) : (\r\n              <Link href={`${basePath}?page=${p}`} className=\"px-3 py-2 rounded-md bg-white border text-gray-700 hover:bg-gray-50\">\r\n                {p}\r\n              </Link>\r\n            )}\r\n          </li>\r\n        ))}\r\n\r\n        <li>\r\n          {showNext ? (\r\n            <Link href={`${basePath}?page=${page + 1}`} className=\"px-3 py-2 rounded-md bg-white border text-gray-700 hover:bg-gray-50\">\r\n              Next\r\n            </Link>\r\n          ) : (\r\n            <span className=\"px-3 py-2 rounded-md bg-gray-100 text-gray-400 border\">Next</span>\r\n          )}\r\n        </li>\r\n      </ul>\r\n    </nav>\r\n  );\r\n}\r\n\r\nfunction getPageNumbers(current: number, total: number) {\r\n  // Simple pager: show up to 5 pages centered on current\r\n  const maxDisplay = 5;\r\n  const pages: number[] = [];\r\n\r\n  if (total <= maxDisplay) {\r\n    for (let i = 1; i <= total; i++) pages.push(i);\r\n    return pages;\r\n  }\r\n\r\n  let start = Math.max(1, current - Math.floor(maxDisplay / 2));\r\n  let end = start + maxDisplay - 1;\r\n\r\n  if (end > total) {\r\n    end = total;\r\n    start = total - maxDisplay + 1;\r\n  }\r\n\r\n  for (let i = start; i <= end; i++) pages.push(i);\r\n  return pages;\r\n}\r\n"],"names":[],"mappings":"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","debugId":null}}]
}